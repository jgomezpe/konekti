{"html":"<div id='·id·Modal'></div>\n<div id='·id·JSnavbar' class='w3-bar'></div>\n<div id='·id·JSeditor' class='·half·' style='position:relative;height:·height·%'></div>    \n<div class='·half·' style='position:relative;height:·height2·%'>\n    <div id='·id·JSerror' style='position:relative; height:100%; width:100%; overflow:scroll; white-space: pre-wrap; display:none' class='w3-container w3-text-red'></div>\n    <div id='·id·JSconsole' style='position:relative; height:100%; width:100%; white-space: pre-wrap; display:none' ></div>\n</div> ","js":"class JSClient extends KonektiClient{\n\tconstructor( id, client, url, user ){\n\t    super(id)\n\t    this.client = client\n\t\tthis.edit={}\n\t\tthis.annot = []\n\t\tif( user != null ) this.user = user\n\t\tif( url != null ) this.url = url\n\t}\n\n\teditor(e){\n\t\tthis.edit[e.id]=e\n\t\tif(e.id==this.id+'JSeditor' && typeof this.client != 'undefined'){\n    \t    Konekti.client[this.client].editor(e)\n    \t    Konekti.client[this.client].edit[this.id] = e\n\t\t}    \n\t}\n\n\tannotation(id, annot){\n\t        this.annot = []\n            for (var i=0; i<annot.length; i++) {\n                if( annot[i].type == 'error' ) this.annot.push(annot[i])\n            }\n\t}\n\t\n\tposition(){\n\t    var editor = this.id+'JSeditor'\n\t    var modal = this.id+'Modal'\n\t    Konekti.plugin.modal.show(modal, this.edit[editor].cursorIndex())\n\t}\n\t\n\trun(){\n\t\tvar id = this.id\n\t\tvar error = id+'JSerror'\n\t\tvar editor = id+'JSeditor'\n\t\tvar jsconsole = id+'JSconsole'\n\t\tvar cerror = Konekti.util.vc(error)\n\t\tvar cconsole = Konekti.util.vc(jsconsole)\n\t    if( this.annot.length == 0 ){\n\t        cconsole.style.display = 'block' \n\t        cerror.style.display = 'none' \n    \t\tvar code = this.edit[editor].getText()\n    \t\tthis.edit[jsconsole].setText(\"<!DOCTYPE html>\\n\"+\n    \t\t\t\"<html>\\n<head>\\n\"+\n    \t\t\t\"\t<meta charset='UTF-8'>\\n\"+\n    \t\t\t\"\t<meta name='viewport' content='width=device-width, initial-scale=1'>\\n\"+\n    \t\t\t\"\t<link rel='stylesheet' href='https://www.w3schools.com/w3css/4/w3.css'>\\n</head>\\n\"+\n    \t\t\t\"<body>\\n\"+\n    \t\t\t\"\t<div id='error' class='w3-container w3-text-red'></div>\\n\"+\n    \t\t\t\"\t<div id='out' style='position:relative; height:100%; width:100%; overflow:auto; white-space: pre-wrap;' class='w3-container'>Output:</div>\"+\n    \t\t\t\"\t<script>\\n\"+\n    \t\t\t\"\t\tconsole.log = function(txt){document.getElementById('out').innerHTML = document.getElementById('out').innerHTML+'\\\\n'+txt}\\n\"+\n    \t\t\t\"\t\ttry {\\n\"+ \n    \t\t\t\"\t\t\"+code+\"\\n\"+\n    \t\t\t\"\t\t} catch(e){\\n\"+\n    \t\t\t\"\t\t\tdocument.getElementById('error').innerHTML = e.message\\n\"+\n    \t\t\t\"\t\t}\\n\"+\n    \t\t\t\"\t</\"+\"script>\\n\"+\n    \t\t\t\"</body>\\n\"+\n    \t\t\t\"</html>\"\n    \t\t)\n    \t}else{\n\t        cconsole.style.display = 'none' \n\t        cerror.style.display = 'block' \n    \t\tvar s = ''\n    \t\tvar annot = this.annot\n    \t    for( var i=0; i<annot.length; i++ ){\n                s += '' + annot[i].type + ':' + annot[i].text + \" on line \" + (annot[i].row+1) + \" column \" + (annot[i].column+1) + '\\n'\n    \t    }\n    \t    cerror.innerHTML = s\n    \t}\n\t}\n\t\n\tcloseModal(){\n        Konekti.plugin.modal.close(this.id+'Modal')\n\t}\n\t\n\tfile(){\n\t\tKonekti.plugin.modal.cloudfilemanager(this.id+'Modal',this.id,this.url)\n\t}\n\t\n\tdelFile(file){\n\t\tif( !file.endsWith('/') ) this.closeModal()\n\t}\n\t\n\treadFile(file){\n\t    this.closeModal()\n        this.edit[this.id+'JSeditor'].setText(file)\n    }\n\t\n\tgetFile(file){                \n\t\treturn this.edit[this.id+'JSeditor'].getText()\n\t}\n    \n\tstoreFile(file){\n        this.closeModal()\n\t}\n\t\n}\n\nKonekti.plugin.javascript.htmlCode = function( dictionary ){\n\tif(typeof dictionary.half == 'string' && dictionary.half=='w3-half'){\n\t    dictionary.height = 100 \n\t    dictionary.height2 = 100\n\t}\n\telse{\n\t    dictionary.height = 56.25 \n\t    dictionary.height2 = 43.75\n\t}\n    return Konekti.util.fromTemplate( this.htmlTemplate, dictionary, '·' )\n}\n\nKonekti.plugin.javascript.connect = function( dictionary ){\n    \n    var mainclient = dictionary.client\n    \n\tvar id = dictionary.id\n\tvar client = id\n\tdictionary.client = client\n\n\tvar user = null\n\tif( typeof dictionary.user == 'string' ) user = Konekti.client[dictionary.user].user\n\n\tvar url = null\n\tif( typeof dictionary.url == 'string' ) url = dictionary.url\n\n    var theClient = new JSClient(client, mainclient, url, user)\n\tKonekti.client[client] = theClient\n\n\tvar nav = dictionary.navbarid || id+'JSnavbar'\n\n    var btn = [{\"id\":\"run\",\"tooltip\":dictionary.run,\"fa\":\"fa fa-play-circle-o\"}]\n    if( url != null ) btn.push({\"id\":\"file\",\"tooltip\":\"File\", \"fa\":\"fa fa-file\"})\n\tif(typeof dictionary.position != 'undefined')\n\t    btn.push({\"id\":\"position\",\"tooltip\":dictionary.position,\"fa\":\"fa fa fa-hand-o-left\"})\n\n    var navbar = {\n\t\t\t\"id\":nav,\n\t\t\t\"client\":client,\n\t\t\t\"color\":\"blue-grey\",\n\t\t\t\"search\":false,\n\t\t\t\"btn\":btn\n\t}\n\t\n\n\tKonekti.plugin.navbar.replaceWith(navbar)\n\t\n\tvar editor = id+'JSeditor'\n\tKonekti.plugin.editor.replaceWith(\n\t\t{ \n\t\t\t\"id\":editor,\n\t\t\t\"client\":client,\n\t\t\t\"theme\":\"chrome\", \n\t\t\t\"initial\":dictionary.initial, \n\t\t\t\"mode\":\"javascript\"\n\t\t}\n\t)\n\n\tvar jsconsole = id+'JSconsole'\n\tKonekti.plugin.iframe.replaceWith(\n\t\t{ \n\t\t\t\"id\":jsconsole,\n\t\t\t\"client\":client,\n\t\t\t\"src\":\"\"\n\t\t}\n\t)\n}\n","copyright":"Copyright (c) 2019 by Jonatan Gomez-Perdomo. All rights reserved. See <A HREF='https://github.com/jgomezpe/konekti'>License</A>.","uses":["navbar","editor","iframe"]}